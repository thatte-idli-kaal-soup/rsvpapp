{% extends 'base.html' %}

{% block content %}
    {% for user in users %}
        {% if loop.index % 3 == 1 %}
            <div class="row">
        {% endif %}
        {% set is_self = current_user.email == user.email %}
        <div class="col-sm-4">
            <div class="card bg-{% if is_self %}dark text-white{% else %}light{% endif %} mb-3">
                <div class="card-header">
                    {{ user.name }}
                    {% for role in user.roles %}
                        <span class="badge badge-info">{{role}}</span>
                    {% endfor %}
                </div>
                <div class="card-body">
                    {% if is_self %}
                        {% include 'user_form.html' %}
                    {% else %}
                        {% include 'user_display.html' %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% if loop.index % 3 == 0 or loop.last %}
            </div>
        {% endif %}
    {% endfor %}
    <p class="h6">{{users|length}} users have registered</p>
{% endblock %}
